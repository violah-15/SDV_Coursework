<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>London Housing Analysis</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="visualization-container">
    <div id="map-container">
        <!-- Map will be appended here by D3 -->
    </div>
    <div id="borough-message">
        Click map to choose borough
    </div>
    <div id="controls">
        <button class="button" id="affordability">Affordability Ratio</button>
        <button class="button" id="earnings">Median Workplace Earnings</button>
        <button class="button" id="house-prices">Median House Prices</button>
    </div>
    <div id="slider-container">
        <button id="play-button">Run</button>
        <label for="year-slider">Year</label><input type="range" id="year-slider" min="1997" max="2022" value="1997" step="1">
        <span id="year-display">1997</span>
    </div>
    <div id="line-graphs">
        <div id="affordability-ratio-graph">
            <h3>Affordability Ratio</h3>
            <!-- Affordability ratio line graph will be appended here by D3 -->
        </div>
    </div>
    <div id="Process">
        <h3>Datasets used for this visualization include:</h3>
        <ul>
            <li>Data sourced from the Office for National Statistics (ONS) for housing and earnings ratios available at <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/housing/datasets/ratioofhousepricetoworkplacebasedearningslowerquartileandmedian">ONS Housing and Earnings Ratios</a>.</li>
            <li>Data on residential property sales for administrative geographies from ONS available at <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/housing/datasets/residentialpropertysalesforadministrativegeographies">ONS Residential Sales</a>.</li>
            <li>TopoJson data for London Boroughs from <a href="https://vega.github.io/vega-datasets/data/londonBoroughs.json">Vega Datasets</a>.</li>
        </ul>
        <h3>The data was processed using Python (process.py) as follows:</h3>
        <ol>
            <li>Extracts data specifically for the London region by filtering rows based on region codes (e.g., E12000007). This involves reading specific sheets designated for the data types of interest (e.g., median house prices, earnings).</li>
            <li>Columns related to specific years or terms (e.g., columns containing the term "Sep" or specific years) are selectively dropped or reformatted.</li>
            <li>Combines data from multiple sources into a unified structure. For example, sales data and ratio data are merged based on common keys such as 'Local authority code' and 'Local authority name'. This results in a comprehensive dataset that aligns both types of data per local authority.</li>
            <li>The script organizes the merged data into a nested dictionary, where each key (borough) has a nested structure containing yearly data on sales, house prices, earnings, and affordability ratios. This transformation is designed to facilitate easier access to data by year and borough, making it suitable for detailed analyses or visualization purposes.</li>
            <li>The final structured data is saved in JSON format, making it easy to use in web applications, data services, or further analytical processes.</li>
        </ol>
    </div>
</div>
<script src="script.js"></script>
</body>
</html>
